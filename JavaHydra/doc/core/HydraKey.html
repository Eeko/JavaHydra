<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_26) on Mon Sep 12 16:07:47 CEST 2011 -->
<TITLE>
HydraKey
</TITLE>

<META NAME="date" CONTENT="2011-09-12">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="HydraKey";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/HydraKey.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraFileHandler.html" title="class in org.glite.data.hydra.javacli.core"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraSettings.html" title="class in org.glite.data.hydra.javacli.core"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?org.glite.data.hydra.javacli.core/HydraKey.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HydraKey.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.glite.data.hydra.javacli.core</FONT>
<BR>
Class HydraKey</H2>
<PRE>
java.lang.Object
  <IMG SRC="../resources/inherit.gif" ALT="extended by ">javax.crypto.spec.SecretKeySpec
      <IMG SRC="../resources/inherit.gif" ALT="extended by "><B>org.glite.data.hydra.javacli.core.HydraKey</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.io.Serializable, java.security.Key, java.security.spec.KeySpec, javax.crypto.SecretKey</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>HydraKey</B><DT>extends javax.crypto.spec.SecretKeySpec</DL>
</PRE>

<P>
The class to extend SecretKeySpec to contain and handle the subclass of HydraKeys.
 We mostly require to add the information on the amount of keys required for reconstruction
 and to add the helper methods to disassemble and reassemble individual keys.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>ekorhone</DD>
<DT><B>See Also:</B><DD><A HREF="../serialized-form.html#org.glite.data.hydra.javacli.core.HydraKey">Serialized Form</A></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#HydraKey(byte[], java.lang.String, java.math.BigInteger, java.lang.Integer, java.lang.Integer)">HydraKey</A></B>(byte[]&nbsp;key,
         java.lang.String&nbsp;algorithm,
         java.math.BigInteger&nbsp;prime,
         java.lang.Integer&nbsp;n,
         java.lang.Integer&nbsp;k)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor for HydraKey.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.math.BigInteger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#combineKey(java.util.Map, java.lang.Integer, int, java.math.BigInteger)">combineKey</A></B>(java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;&nbsp;parts,
           java.lang.Integer&nbsp;n,
           int&nbsp;k,
           java.math.BigInteger&nbsp;prime)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#createWithPadding(byte[], java.lang.String, java.math.BigInteger, java.lang.Integer, java.lang.Integer, java.lang.Integer)">createWithPadding</A></B>(byte[]&nbsp;key,
                  java.lang.String&nbsp;algorithm,
                  java.math.BigInteger&nbsp;prime,
                  java.lang.Integer&nbsp;n,
                  java.lang.Integer&nbsp;k,
                  java.lang.Integer&nbsp;length)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the default constructor with additional parameter length (in bytes) to
 create a key with appropriate zero-padding</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#generateKey()">generateKey</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generates a new HydraKey with default settings.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#generateKey(java.lang.String, int, java.math.BigInteger, int, int)">generateKey</A></B>(java.lang.String&nbsp;algorithm,
            int&nbsp;length,
            java.math.BigInteger&nbsp;prime,
            int&nbsp;n,
            int&nbsp;k)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Takes arguments to define the key-generation procedure</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#getInitializationVector()">getInitializationVector</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the initialization vector of HydraKey instance if one is stored with key-information.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.math.BigInteger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#getKeyBI()">getKeyBI</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the secret key of HydraKey in BigInteger-representation</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.math.BigInteger[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#getParameters()">getParameters</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lists the parameters of the object in a array of 
 {prime, n, k}</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.List&lt;com.tiemens.secretshare.engine.SecretShare.ShareInfo&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#mapToShareInfo(java.util.Map, int, int, java.math.BigInteger)">mapToShareInfo</A></B>(java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;&nbsp;map,
               int&nbsp;n,
               int&nbsp;k,
               java.math.BigInteger&nbsp;prime)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maps a Map<Integer, BigInteger> to List<ShareInfo> from com.tiemens.secretshare</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#padToLength(int)">padToLength</A></B>(int&nbsp;length)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This function pads the secret key stored by HydraKey to a given length if 
 it needs to be of certain length.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#reconstructKey(java.util.Map, java.lang.Integer, int, java.math.BigInteger, java.lang.String)">reconstructKey</A></B>(java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;&nbsp;shares,
               java.lang.Integer&nbsp;n,
               int&nbsp;k,
               java.math.BigInteger&nbsp;prime,
               java.lang.String&nbsp;algorithm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A function to reconstruct a key from slices</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#setInitializationVector(byte[])">setInitializationVector</A></B>(byte[]&nbsp;iv)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the initialization vector of HydraKey instance if it is one needed to be stored with key-information.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#shareInfoToMap(java.util.List)">shareInfoToMap</A></B>(java.util.List&lt;com.tiemens.secretshare.engine.SecretShare.ShareInfo&gt;&nbsp;shares)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maps a List<ShareInfo> from com.tiemens.secretshare to a common
 Map<Integer, BigInteger> from java.util.map</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html#splitKey(int, int)">splitKey</A></B>(int&nbsp;n,
         int&nbsp;k)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Splits the key to a Map<index_of_keypart, keypart> object</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_javax.crypto.spec.SecretKeySpec"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class javax.crypto.spec.SecretKeySpec</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getAlgorithm, getEncoded, getFormat, hashCode</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>getClass, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="HydraKey(byte[], java.lang.String, java.math.BigInteger, java.lang.Integer, java.lang.Integer)"><!-- --></A><H3>
HydraKey</H3>
<PRE>
public <B>HydraKey</B>(byte[]&nbsp;key,
                java.lang.String&nbsp;algorithm,
                java.math.BigInteger&nbsp;prime,
                java.lang.Integer&nbsp;n,
                java.lang.Integer&nbsp;k)</PRE>
<DL>
<DD>Constructor for HydraKey. Nearly identical to the SecretKeySpec,
 but takes another parameter "prime", if we wish to use any other value
 for SSS than the default 16-bit prime used by the C-implementation
 org.glite.security.ssss.
 
 prime, n and k are stored within the object to offer a convenient place to store that metadata to 
 easen future application-development
 
 NOTE: Initialization does not by default accept a value for Initialization vector (set to null)
 You can generate it separately and add it with setInitializationVector(String) -method
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - The encryption key in byte-array<DD><CODE>algorithm</CODE> - The algorithm to be used for key-generation
 See <CODE>http://download.oracle.com/javase/1.5.0/docs/guide/security/jce/JCERefGuide.html</CODE>        JCE Reference
 for<DD><CODE>prime</CODE> - The prime-number to be used for splitting. If set as @null,<DD><CODE>k</CODE> - the threshold of key (null => 2)<DD><CODE>n</CODE> - the amount of shares in key (null => 3)
 defaults to 16-bit value of org.glite.security.ssss.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getParameters()"><!-- --></A><H3>
getParameters</H3>
<PRE>
public java.math.BigInteger[] <B>getParameters</B>()</PRE>
<DL>
<DD>Lists the parameters of the object in a array of 
 {prime, n, k}
<P>
<DD><DL>

<DT><B>Returns:</B><DD>array of BigIntegers containing the values in order {prime, n, k}</DL>
</DD>
</DL>
<HR>

<A NAME="shareInfoToMap(java.util.List)"><!-- --></A><H3>
shareInfoToMap</H3>
<PRE>
public java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt; <B>shareInfoToMap</B>(java.util.List&lt;com.tiemens.secretshare.engine.SecretShare.ShareInfo&gt;&nbsp;shares)</PRE>
<DL>
<DD>Maps a List<ShareInfo> from com.tiemens.secretshare to a common
 Map<Integer, BigInteger> from java.util.map
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>shareArray</CODE> - the array to be mapped
<DT><B>Returns:</B><DD>the mapping</DL>
</DD>
</DL>
<HR>

<A NAME="splitKey(int, int)"><!-- --></A><H3>
splitKey</H3>
<PRE>
public java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt; <B>splitKey</B>(int&nbsp;n,
                                                                      int&nbsp;k)</PRE>
<DL>
<DD>Splits the key to a Map<index_of_keypart, keypart> object
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>n</CODE> - the amount of total slices<DD><CODE>k</CODE> - the threshold to be needed for reconstruction
<DT><B>Returns:</B><DD>The mapping in a standard java.util.map object</DL>
</DD>
</DL>
<HR>

<A NAME="getKeyBI()"><!-- --></A><H3>
getKeyBI</H3>
<PRE>
public java.math.BigInteger <B>getKeyBI</B>()</PRE>
<DL>
<DD>Returns the secret key of HydraKey in BigInteger-representation
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the BigInteger representation of Key in store
 
  TODO: this kind of methods should probably not be present. Or public.
  Giving extra information whether a HydraKey matches another HydraKey presents a security threat.
  Find a way to allow these checks only within the unit tests (e.g. org.glite.data.hydra.javacli.tests by encryption/decryption results)</DL>
</DD>
</DL>
<HR>

<A NAME="setInitializationVector(byte[])"><!-- --></A><H3>
setInitializationVector</H3>
<PRE>
public void <B>setInitializationVector</B>(byte[]&nbsp;iv)</PRE>
<DL>
<DD>Set the initialization vector of HydraKey instance if it is one needed to be stored with key-information.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>iv</CODE> - The string containing iv</DL>
</DD>
</DL>
<HR>

<A NAME="getInitializationVector()"><!-- --></A><H3>
getInitializationVector</H3>
<PRE>
public byte[] <B>getInitializationVector</B>()</PRE>
<DL>
<DD>Get the initialization vector of HydraKey instance if one is stored with key-information.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>The IV</DL>
</DD>
</DL>
<HR>

<A NAME="padToLength(int)"><!-- --></A><H3>
padToLength</H3>
<PRE>
public <A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A> <B>padToLength</B>(int&nbsp;length)
                     throws java.lang.Exception</PRE>
<DL>
<DD>This function pads the secret key stored by HydraKey to a given length if 
 it needs to be of certain length.
 Required for example, if we have randomly generated key beginning with zero-byte.
 Reconstructing that key with SSS would normally only create a key of length
 original_key_length - 1 (in bytes). E.g. key 0,1,2,3,4,5 (BigEndian)splitted and reconstructed
 would render 1,2,3,4,5 .
 
 This is useful, since the plugin used (SSS implementation in java) works with BigIntegers, and 
 requires them to be positive. Java does not natively support unsigned-arithmetic, so we avoid a
 lot of pitfalls and re-implementing the SSS by preprocessing our inputs.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>length</CODE> - The length of the final (padded) key
<DT><B>Returns:</B><DD>HydraKey The new key with proper padding
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - if the length is smaller than the original byte-array of HydraKey</DL>
</DD>
</DL>
<HR>

<A NAME="createWithPadding(byte[], java.lang.String, java.math.BigInteger, java.lang.Integer, java.lang.Integer, java.lang.Integer)"><!-- --></A><H3>
createWithPadding</H3>
<PRE>
public static <A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A> <B>createWithPadding</B>(byte[]&nbsp;key,
                                         java.lang.String&nbsp;algorithm,
                                         java.math.BigInteger&nbsp;prime,
                                         java.lang.Integer&nbsp;n,
                                         java.lang.Integer&nbsp;k,
                                         java.lang.Integer&nbsp;length)
                                  throws java.lang.Exception</PRE>
<DL>
<DD>Uses the default constructor with additional parameter length (in bytes) to
 create a key with appropriate zero-padding
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - The encryption key in byte-array<DD><CODE>algorithm</CODE> - The algorithm to be used for key-generation
 See <CODE>http://download.oracle.com/javase/1.5.0/docs/guide/security/jce/JCERefGuide.html</CODE>        JCE Reference
 for<DD><CODE>prime</CODE> - The prime-number to be used for splitting. If set as @null,<DD><CODE>k</CODE> - the threshold of key (null => 2)<DD><CODE>n</CODE> - the amount of shares in key (null => 3)<DD><CODE>length</CODE> - the lenght of new key in bytes
<DT><B>Returns:</B><DD>Newly generated hydrakey with appropriate padding
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - if the new length is smaller than the original key</DL>
</DD>
</DL>
<HR>

<A NAME="mapToShareInfo(java.util.Map, int, int, java.math.BigInteger)"><!-- --></A><H3>
mapToShareInfo</H3>
<PRE>
public static java.util.List&lt;com.tiemens.secretshare.engine.SecretShare.ShareInfo&gt; <B>mapToShareInfo</B>(java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;&nbsp;map,
                                                                                                  int&nbsp;n,
                                                                                                  int&nbsp;k,
                                                                                                  java.math.BigInteger&nbsp;prime)</PRE>
<DL>
<DD>Maps a Map<Integer, BigInteger> to List<ShareInfo> from com.tiemens.secretshare
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>Map<Integer,</CODE> - BigInteger> to be Listed<DD><CODE>n</CODE> - amount of shares in the original split<DD><CODE>k</CODE> - amount of shares needed to regenerate secret<DD><CODE>prime</CODE> - (can be null)
<DT><B>Returns:</B><DD>the mapping to List<com.tiemens.secretshare.ShareInfo></DL>
</DD>
</DL>
<HR>

<A NAME="combineKey(java.util.Map, java.lang.Integer, int, java.math.BigInteger)"><!-- --></A><H3>
combineKey</H3>
<PRE>
public static java.math.BigInteger <B>combineKey</B>(java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;&nbsp;parts,
                                              java.lang.Integer&nbsp;n,
                                              int&nbsp;k,
                                              java.math.BigInteger&nbsp;prime)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="generateKey()"><!-- --></A><H3>
generateKey</H3>
<PRE>
public static <A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A> <B>generateKey</B>()
                            throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Generates a new HydraKey with default settings.
 
 Uses blowfish to generate a 128-bit key. Uses 16-bit prime for splitting.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Returns the HydraKey-instance
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="generateKey(java.lang.String, int, java.math.BigInteger, int, int)"><!-- --></A><H3>
generateKey</H3>
<PRE>
public static <A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A> <B>generateKey</B>(java.lang.String&nbsp;algorithm,
                                   int&nbsp;length,
                                   java.math.BigInteger&nbsp;prime,
                                   int&nbsp;n,
                                   int&nbsp;k)
                            throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Takes arguments to define the key-generation procedure
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>algorithm</CODE> - the algorithm to be used.<DD><CODE>length</CODE> - the length of the wanted key in bits<DD><CODE>prime</CODE> - the (large) prime to be used with hydra key-splitting
<DT><B>Returns:</B><DD>a valid HydraKey generated randomly
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="reconstructKey(java.util.Map, java.lang.Integer, int, java.math.BigInteger, java.lang.String)"><!-- --></A><H3>
reconstructKey</H3>
<PRE>
public static <A HREF="../org.glite.data.hydra.javacli.core/HydraKey.html" title="class in org.glite.data.hydra.javacli.core">HydraKey</A> <B>reconstructKey</B>(java.util.Map&lt;java.lang.Integer,java.math.BigInteger&gt;&nbsp;shares,
                                      java.lang.Integer&nbsp;n,
                                      int&nbsp;k,
                                      java.math.BigInteger&nbsp;prime,
                                      java.lang.String&nbsp;algorithm)</PRE>
<DL>
<DD>A function to reconstruct a key from slices
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>shares</CODE> - a map of <key_slice_index, keyslice_value><DD><CODE>prime</CODE> - The prime used to reconstruct the modulo
 TODO: is this necessary for the algorithm?<DD><CODE>algorithm</CODE> - the algorithm used (set to Unknown if null)<DD><CODE>k</CODE> - the threshold on needed key-amount<DD><CODE>n</CODE> - the amount of total keys (can be null)
<DT><B>Returns:</B><DD>a new instance of HydraKey constructed from the pieces given</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/HydraKey.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraFileHandler.html" title="class in org.glite.data.hydra.javacli.core"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../org.glite.data.hydra.javacli.core/HydraSettings.html" title="class in org.glite.data.hydra.javacli.core"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?org.glite.data.hydra.javacli.core/HydraKey.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HydraKey.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
